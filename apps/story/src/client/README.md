# Unified Backend API Client

This directory contains the wrapper for the auto-generated API client.

## Directory Structure

```
src/
├── api-client/          # Auto-generated files (regenerated by pnpm generate:client)
│   ├── sdk.gen.ts       # All API function calls
│   ├── types.gen.ts     # TypeScript types
│   └── ...              # Other generated files
└── client/              # Manual wrapper files (NOT regenerated)
    ├── config.ts        # Client configuration and re-exports
    └── README.md        # This file
```

## Usage

Always import from `@/client/config`, never directly from `api-client`:

```typescript
import { getMyStories, postMyStories } from '@/client/config'

// List stories
const result = await getMyStories({
  query: { page: 1, limit: 20 }
})

// Create story
const created = await postMyStories({
  body: { name: 'My Story', summary: 'Epic tale' }
})
```

## Regenerating the Client

When the unified backend API changes:

```bash
# Make sure unified-backend is running on port 3201
pnpm --filter story generate:client
```

This regenerates everything in `src/api-client/` but leaves `src/client/` untouched.

## Configuration

The client is configured to:
- Use `http://localhost:3201` by default
- Include credentials (cookies) in all requests for session auth
- Support runtime config via `window.RUNTIME_CONFIG.BACKEND_URL` (for Docker)
- Support build-time config via `VITE_UNIFIED_API_URL` env var

## Available Endpoints

All 130+ endpoints are available as typed functions:

- **Auth**: `postAuthRegister`, `postAuthLogin`, `postAuthLogout`, `getAuthSession`
- **Stories**: `getMyStories`, `postMyStories`, `getMyStoriesById`, `patchMyStoriesById`, `deleteMyStoriesById`, `getMyStoriesByIdExport`
- **Hierarchy**: Books, Arcs, Chapters, Scenes, Messages
- **Content**: MessageRevisions, Paragraphs, ParagraphRevisions
- **Characters**: `getMyStoriesByStoryIdCharacters`, `postMyStoriesByStoryIdCharacters`, etc.
- **Context Items**: Locations, themes, plots
- **Files**: Upload, list, delete
- **Tags**: Global tags + story associations
- **Calendars**: Presets, CRUD, default calendar
- **Maps**: Maps, landmarks, pawns, paths, segments

See the generated `types.gen.ts` for full type definitions.
